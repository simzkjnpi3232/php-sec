# PHP App ② レビュー

## XSS(クロスサイトスクリプティング)

### XSSとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- XSSとは
  - ユーザーのアクセス時に表示内容が生成される「動的Webページ」の脆弱性、もしくはその脆弱性を利用した攻撃方法です。
- 攻撃側のメリット
  - cookie情報の取得
  - 取得した情報を使って、被害者の権限で不正な操作が可能です。
  - ユーザーのなりすましが可能になり、個人情報やクレジットカード情報を取得できます。

### `htmlspecialchars()`を`e()`として定義しなおすメリットを説明してください。
- e()という短い関数名を使うことで、コードを簡潔に記述できます。

### `htmlspecialchars()`を使うことでなぜXSSが防げるのか説明してください。
- スクリプトタグがただの文字列として扱われるようになったためです。

## CSRF(クロスサイトリクエストフォージェリ)

### CSRFとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- 不特定多数の人に対して意図しないリクエスト送信をさせる攻撃です。
  - メリット
    - 攻撃者は被害者の認証済み状態を利用できる
    - 銀行や決済サービスで送金処理を実行
    - 被害者のアカウントを乗っ取る

### SessionとCookieの違いを説明してください。
- SessionとCookieの違いは下記になります。
  - Session：サーバ側でデータを一時的に保存する
  - Cookie：ブラウザ側でデータを一時的に保存する

### `setToken()`が何をしているか説明してください。
- 下記の手順でtoken を SESSION に保存しています。
  - openssl_random_pseudo_bytes(16)で、ランダムな 16 文字のバイト文字列を生成
  - 上記で生成した文字列を bin2hex で 16 進数に変換
  - 生成された値を $_SESSION['token'] に格納

### `checkToken()`が何をしているか説明してください。
- SESSIONにtokenを格納しています。

### トークンを使うことでなぜCSRFが防げるのか説明してください。
- トークンを使ってリクエスト元が正しいかチェックするため
  - クライアントとサーバ間でセッションに紐づくトークンが保持されており、
外部の HTML はこのトークンを保持していないためリクエストを受け付けられません。

## SQLインジェクション

### SQLインジェクションとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- アプリケーションが想定しないSQL文を実行させる攻撃方法です。
  - メリット
    - データベースシステムを操作できる

### `->prepare()`の返り値と、またこのメソッドが何をしているか説明してください。
- 返り値：PDOステートメントオブジェクト
  - SQL文を実行する準備をしています。

### `->bindValue()`が何をしているか説明してください。
- 指定したデータ型の値ををプレースホルダに格納しています。

### 今回の対策でなぜSQLインジェクションが防げるのか説明してください。
- ユーザーの入力値を文字列と認識させてSQL文に代入しているためです。

## バリデーション

### バリデーションの目的について説明してください。
- 入力された値が、制限通りの内容になっているかどうかを確認するため

### `validate()`が何をしているか説明してください。
- 自分の意図通りにユーザーがフォーム要素へ入力できているかを検証します。

### `isset($post['content'])`はなぜ必要か、無い場合どうなるか説明してください。
- $post['content']が定義されているか確認するためです。
  - 無い場合削除機能を使用した際エラーが発生します。

## その他

### `unsetError()`を実行しないとどうなるか説明してください。
- エラーメッセージが表示されたあと、残ってしまいます。
